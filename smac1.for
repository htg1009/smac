
      SUBROUTINE SMAC
C     Version 03-02-83
C     SIMULATION MODEL OF AUTOMOBILE COLLISIONS -SMAC
C     PROGRAM VERSION 10-31-78
C
C     THE FOLLOWING MODIFICATIONS HAVE BEEN MADE TO THE ORIGINAL SOURCE
C     RECEIVED FROM CALSPAN
C
C         (A)  STATEMENT NUMBER 55 IN SUBROUTINE TRAJ WHICH READ
C                                    55 RATIO = XNUM/XDEN
C              NOW READS
C                                    55 RATIO = ATAN2(XNUM,XDEN)
C
C         (B)  AN HSRI VERSION DATE WRITE STATEMENT HAS BEEN ADDED AS
C              THE FIRST EXECUTABLE STATEMENT IN MAIN
C
C         (C)  THE UNREFERENCED VARIABLE "BLNK" WAS DELETED FROM
C              SUBROUTINES OUT2, ADJEND, DAMAGE, DEFMJ, AND PLOTAP
C
C         (D)  THE UNREFERENCED VARIABLE "STAR" WAS DELETED FROM
C              SUBROUTINES OUT2 AND DAMAGE
C
C         (E)  THE UNREFERENCED VARIABLES "PIO4", "PIO6", AND "PIO9"
C              WERE DELETED FROM SUBROUTINE DAMAGE
C
C         (F)  THE MAIN PROGRAM HAS BEEN CONVERTED TO A SUBROUTINE
C
      COMMON/CONST/ G,RAD,PI,TWOPI,PIO2,PI32,ND2,ND4,ND8,NIN,NOUT
C
      COMMON/INTG/NEQ,T,DT,VAR(12),DER(12)
C
      EQUIVALENCE (VAR(1),XCP1),(VAR(2),YCP1),(VAR(3),PSI1),
     1            (VAR(4),PSI1D),(VAR(5),U1),(VAR(6),V1),
     2            (VAR(7),XCP2),(VAR(8),YCP2),(VAR(9),PSI2),
     3            (VAR(10),PSI2D),(VAR(11),U2),(VAR(12),V2)
C
      EQUIVALENCE (DER(1),DXCP1),(DER(2),DYCP1),(DER(3),DPSI1),
     1            (DER(4),DPSI1D),(DER(5),DU1),(DER(6),DV1),
     2            (DER(7),DXCP2),(DER(8),DYCP2),(DER(9),DPSI2),
     3            (DER(10),DPSI2D),(DER(11),DU2),(DER(12),DV2)
C
      COMMON/INPT/  T0,TF,DTTRA0,DTCOL0,DTCLT0,DTPRN0,UVMIN,PSIDMN,FVEH0
     1             ,XCP10,YCP10,PSI10,PSI1D0,U10,V10,
     2              XCP20,YCP20,PSI20,PSI2D0,U20,V20,
     3              A1,B1,TR1,FIZ1,FM1,PSIR10,XF1,XR1,YS1,
     4              A2,B2,TR2,FIZ2,FM2,PSIR20,XF2,XR2,YS2,
     5              CSTFI(8),TBTQ1,TETQ1,TINCQ1,NTBLQ1,NTQ1,
     6              TBTQ2,TETQ2,TINCQ2,NTBLQ2,NTQ2,TII(8,201),
     7              TBPSF1,TEPSF1,TINCP1,NTBLP1,NPSF1,
     8              TBPSF2,TEPSF2,TINCP2,NTBLP2,NPSF2,PSIFI(4,201),
     9              XBP(2),YBP(2),XMU1,XMU2,CMU
C
      COMMON/INPT/  DELPS0,DELRO0,ALAMB,ZETAV,AKV(2), AMU,C0,C1,C2,
     1              PSLM10,PSLM20,PSLM30,PSLM40,PSLM50,PSLM60,PSLM70,
     2              PSLM80,HED(40),DADE(3),XINPUT(9)
C
      COMMON /OPTIONS/ IOPTION, DTINT, STEPPSI, STEPDT, SINPSI, SINFREQ,
     1                 GAIN, DISLKAHD, DW1F, DW1R, DW2F, DW2R
C
      COMMON/TRAJEC/ ITRAJ,XCIR,YCIR,RWYRAD,XYTB(2,201),DLAT1,DLAT2
     1               ,DYAW1,DYAW2
C
      COMMON/INTGR/JCC(4),JCOR(4),NPSIB,IPSIB0,IPSIB,IBB,IFF,NDTAB,
     1             I9,J9(361,2),  NPSJB,IPSJB,I3,ILAST,IL,IND1,IND2,INDI
     2             ,INDJ,ISTOP,ITZER1,ITZER2,IPZER1,IPZER2,ICOUNT,INDXB,
     3             ICOLLP,ICOLL,IQ,IND,IVEH,LL,ICTVDI,ITCOL,ITFLG1,
     4             ITFLG2,NWRDB1,NWRDE1,NWRDB2,NWRDE2,ICOLAC
C
C     IN COMMON /COMP/ DO NOT DISTURB THE ORDER OF THE VARIABLES
C     WHICH ARE EQUIVALENCED TO ARRAYS.
C
      COMMON/COMP/  DTTRAJ,DTCOLL,DTCOLT,DTPRNT,UVMN2,PSIDMA,TPRINT,DTP,
     1              U1V1SQ,U2V2SQ,DELPSI,DELPST,DELPS2,DELRHO,
     2              PSILM1,PSILM2,PSILM3,PSILM4,PSILM5,PSILM6,PSILM7,
     3              PSILM8,EJJ(4,2),GJJ(4,2),C1OC2,PSCC,PSIR1,PSIR2,
     4             XCMXC1,XCMXC2,YCMYC1,YCMYC2,SPSI1,SPSI2,CPSI1,CPSI2,
     5             XCPI,YCPI,PSII,XCPJ,YCPJ,PSIJ,XCMXC,YCMYC,SPSIJ,
     6             CPSIJ,XFI,XRI,YSI,XFJ,XRJ,YSJ,AKVI,AKVJ,EJ,GJ,
     7             XPJ(4),YPJ(4),ANGYX,SPAN,PSIBPI(4),PSIBPB,PSIBPF,
     8             FNPSIB,PSIBB,PSIB,PSFMPS,SCPSIB,CSPSIB,
     9             RHOBI,RHOBIN(4),PSIBIJ,SPSBIJ,CPSBIJ,XBIJ,YBIJ,PSJTB
C
      COMMON/COMP/ PSIBPJ,FNPSJB,PSIBJ,RHOBJ,XYJSQR,SPSIB,CPSIB,XBI,YBI,
     1         PRESI,PRESJ,XYSR,DELTA,CRHO,RHOBIC,RHOBMX,RHOBIT,RHOBT,
     2             SPSI21,CPSI21,X2TEM,Y2TEM,XX,YY,PAV,XXYYSR,FN1,SPSF,
     3             CPSF,X1AV,Y1AV,XYAVSR,X2TERM,Y2TERM,SPS21F,CPS21F,
     4             X2AV,Y2AV,VT1AV,VT2AV,VTMVT,FRICT,FNX1,FNY1,FNN1,
     5             FNX2,FNY2,FNN2,SFX1,SFY1,SFN1,SFX2,SFY2,SFN2,
     6              SFX1C,SFX2C,SFY1C,SFY2C,SFN1C,SFN2C,
     7              SFX1T,SFX2T,SFY1T,SFY2T,SFN1T,SFN2T, TCOL,TEND,
     8              TREST1,TREST2,TCOLS1,TCOLS2,P1TEM,P2TEM,U1V1E,U2V2E,
     9              EXTRA(10)
C
      COMMON/COMPT/ W(8),XWP(8),YWP(8),FLAGW(8),PSIW(8),TQW(8),
     1             TFX,TFY,TMOM,PSIRR,COEF,COEF1,COEF2,TRD2,TRD21,TRD22,
     2             XBMXB,FNUM,A,B,FIZ,FMASS,XC,YC,U,V,PSIC,PSICD,UD2,
     3             SGNU,SGNI,AOMB,CSPSIC,SNPSIC,TRCPSC,TRSPSC,TRPSCD,
     4             XI,XW,YW,SX,SY,S,XPP,YPP,RHO,RHOP,XMUS,XMU,PSI,XNUM,
     5             XDEN,RATIO,ALFA,F,TIF,FC,FCOS,SMAL,FSMX,FS,BETB,FX,FY
     6             ,CSPSI,SNPSI,XCXC,YCYC,SPJ,CPJ,SPIJ,CPIJ,XFJJ,XRJJ,
     7              YSJJ,EJJI,GJJI,XICORJ,YICORJ,NTQ,TBTQ,TETQ,TINCRQ,
     8             NPSF,TBPSF,TEPSF,TINCRP
C
      COMMON/TAB/  TRHOB(361,2),TROBMX(361,2),TPSIB(361,2),
     1             TCPSIB(361,2),TSPSIB(361,2),TXB1(100),TYB1(100),
     2             TPSB1(100),TPRES1(100)
C
      DIMENSION   XCMXCI(2),YCMYCI(2),SPSII(2),CPSII(2),PSLM0(8),PSLM(8)
C
      EQUIVALENCE (XCMXCI(1),XCMXC1),(YCMYCI(1),YCMYC1),(SPSII(1),SPSI1)
     1           ,(CPSII(1),CPSI1),(PSLM0(1),PSLM10),(PSLM(1),PSILM1)
C
C     COMMON VDICON HAS CONSTANTS USED FOR VEHICLE DAMAGE INDEX
C
      COMMON/VDICON/EXTF1( 9),EXTR1( 9),EXTB1( 9),PSP1(12),
     2              EXTF2( 9),EXTR2( 9),EXTB2( 9),PSP2(12),NCOL51(10),
     2              NCOL52(10),MMM( 9)
C
      EQUIVALENCE (XINPUT(1),FMOVIE)
C
      COMMON/COLLPT/ XCP1C,YCP1C,PSI1C,U1C,V1C,PSI1DC,
     1               XCP2C,YCP2C,PSI2C,U2C,V2C,PSI2DC
C
      COMMON/OUTPT/TMOU(55),XCP1OU(55),YCP1OU(55),PSI1OU(55),U1OU(55),
     1            V1OU(55),PS1DOU(55),AX1OU(55),AY1OU(55),XCP2OU(55),
     2             YCP2OU(55),PSI2OU(55),U2OU(55),V2OU(55),PS2DOU(55),
     3          AX2OU(55),AY2OU(55),ALF1OU(55),ALF2OU(55),XWP1OU(55),
     4             XWP2OU( 55),XWP3OU( 55),XWP4OU( 55), XWP5OU( 55),
     5             XWP6OU( 55),XWP7OU( 55),XWP8OU( 55), YWP1OU( 55),
     6             YWP2OU( 55),YWP3OU( 55),YWP4OU( 55), YWP5OU( 55),
     7             YWP6OU( 55),YWP7OU( 55),YWP8OU( 55), FLAG1( 55),
     8             FLAG2( 55), FLAG3( 55),FLAG4( 55),FLAG5( 55),
     9         FLAG6( 55),FLAG7( 55),FLAG8( 55),ACC1OU(55),ACC2OU(55)
C
      COMMON/OUTPT /ARRXY1(10),ARRX1(10),ARRY1(10),ARRT1(10),ARRPS1(10),
     1   ARRDV1(10),ARRXY2(10),ARRX2(10),ARRY2(10),ARRT2(10),ARRPS2(10),
     2   ARRDV2(10),ABIG1,AXBIG1,AYBIG1,TBIG1,DELVS1,ACC1,ACCP1,AXX1,
     3  AYY1,ACTST1,ABIG2,AXBIG2,AYBIG2,TBIG2,DELVS2,ACC2,ACCP2,AXX2,
     4  AYY2,ACTST2,TM,TIMEP,NARRP1(10),NARRP2(10),NUM1,NUM2,
     5         ISAV1,ISAV2,IACDV1,IACDV2,IPAGE
C
      COMMON /MOVIE/ MOVIE,NMSG
C
      DIMENSION XNTG0(26),XNPT0(2556),INTGR0(768),TAB0(4010),COMP0(189)
      DIMENSION COMPT0(129)
      EQUIVALENCE (T,XNTG0(1)),(T0,XNPT0(1)),(JCC(1),INTGR0(1))
      EQUIVALENCE(DTTRAJ,COMP0(1)),(W(1),COMPT0(1)),(TRHOB(1,1),TAB0(1))
      DIMENSION VDICN(107),COLLP1(12)
      EQUIVALENCE(VDICN (1),EXTF1(1)) ,(COLLP1(1),XCP1C)
      DIMENSION OUTPT0(2644)
      EQUIVALENCE (TMOU(1),OUTPT0(1))
      DATA NO1/1/, NO2/2/
C
      NMSG  = 6
      MOVIE = 0
C
C     PRINT HSRI VERSION DATE
C
C      WRITE(NOUT,100)
C  100 FORMAT('0SMAC - HSRI Version 10-31-78')
C
C	WRITE(NOUT, 100)
C  100 FORMAT('0SMAC - PATH VERSION 1-1-97')
C
          DO 8   I = 1,2556
    8     XNPT0(I) = 0.0
C
C     INPUT AREA CLEARED ONLY ONCE PER JOB
C
      PSLM10 = 70.
      PSLM20 = 110.
      PSLM30 = 250.
      PSLM40 = 290.
      PSLM50 = 10.
      PSLM60 = 170.
      PSLM70 = 190.
      PSLM80 = 350.
C
   10     DO 11 I = 1,26
   11     XNTG0(I) = 0.0
C
          DO 12 I = 1,189
   12     COMP0(I) = 0.0
C
          DO 13 I = 1,129
   13     COMPT0(I) = 0.0
C
          DO 14 I = 1,768
   14     INTGR0(I) =0
C
          DO 15 I = 1,1444
   15     TAB0(I) = -1.0
C
          DO 16 I = 1445,4010
   16     TAB0(I) = 0.0
C
          DO 160 I = 1,107
  160     VDICN(I) = 0.0
C
          DO 161 I = 1,12
  161     COLLP1(I) = 0.0
C
          DO 17 I = 1,2644
   17     OUTPT0(I) = 0.0
C
      IPRTY = 1
      ABIG1 = -1.E10
      ABIG2 = -1.E10
C
C     SUBROUTINE INPUT READS CARDS FURNISHED FOR THIS CASE, ALLOWS
C     SUCCESSIVE CASES WITH ONLY THOSE CARDS WHICH ARE CHANGED,
C     AND PRINTS ALL INPUT FOR EACH CASE.
C
C      CALL INPUT(&9999)
      CALL INPUT(*9999)
C
C     SUBROUTINE CNSTNT RESETS NMSG=2,MOVIE=1 IF FMOVIE.NE.0,INPUT
C
      CALL CNSTNT
      TPRINT = T0
C
      T = T0
      TCOL = T0
      TIMEP = T0
      TM = T0
      TTADD = 0.1 * DTCOLL
      ICOLTR = 1
      DT = DTCOLT
      DTP = DT
C      CALL PLOTAP(1)
      CALL RNGKT1(1,  NEQ,T,DT,VAR,DER)
      CALL ACCEL(G,DU1,DV1,DPSI1,U1,V1,AXX1,AYY1,ACC1)
      IF(IVEH.EQ.0) GO TO 19
      CALL ACCEL(G,DU2,DV2,DPSI2,U2,V2,AXX2,AYY2,ACC2)
C
C     SUBR SAVMAX CALLS SUBR DELTAV, INITIALIZES.
C
      CALL SAVMAX (ARRXY1,ARRX1,ARRY1,ARRT1,ARRDV1,ARRPS1,NARRP1,
     1            TM,TIMEP,AXX1,AYY1,ACC1,ACCP1,DELVS1,ACTST1,
     2            ABIG1,AXBIG1,AYBIG1,TBIG1,NUM1,ISAV1 ,IACDV1,
     3            IPRTY,ISTOP)
      CALL SAVMAX (ARRXY2,ARRX2,ARRY2,ARRT2,ARRDV2,ARRPS2,NARRP2,
     1            TM,TIMEP,AXX2,AYY2,ACC2,ACCP2,DELVS2,ACTST2,
     2            ABIG2,AXBIG2,AYBIG2,TBIG2,NUM2,ISAV2 ,IACDV2,
     3            IPRTY,ISTOP)
      GO TO 31
C
C     T IS T0,  IF TWO VEHICLES, CHECK FOR POSSIBLE CONTACT AT ST 31
C
   18 WRITE(NOUT,6018) T,DT,DTP
 6018 FORMAT('0 At time =',F8.4,' sec, New interval =',F8.4,' sec, Previ
     1ous interval =',F8.4,' sec')
      CALL RNGKT1(1,  NEQ,T,DT,VAR,DER)
      CALL ACCEL(G,DU1,DV1,DPSI1,U1,V1,AXX1,AYY1,ACC1)
      IF(IVEH.EQ.0) GO TO 19
      CALL ACCEL(G,DU2,DV2,DPSI2,U2,V2,AXX2,AYY2,ACC2)
   19 IF(ISTOP.NE.0) GO TO 80
C
C     OMIT CALL TO OUTDIS
C     IF(IVEH.NE.0) CALL OUTDIS
C     ENTRY OUTDIS IN SUBROUTINE OUTPUT PRINTS RHOB TABLE EVERY STEP
C
   20 IF(TPRINT.GT.(T+0.1*DT)) GO TO 21
      CALL OUTPUT(1)
C      CALL PLOTAP(2)
      TPRINT = TPRINT + DTPRNT
   21 ICOLLP = 0
C
      CALL RNGKT1(2,  NEQ,T,DT,VAR,DER)
      IF(ISTOP.NE.0) GO TO 80
      IF(T.GE.TF) GO TO 80
      TIMEP = TM
      TM = T
      ACCP1 = ACC1
      CALL ACCEL(G,DU1,DV1,DPSI1,U1,V1,AXX1,AYY1,ACC1)
      IF(IVEH.EQ.0) GO TO 220
      ACCP2 = ACC2
      CALL ACCEL(G,DU2,DV2,DPSI2,U2,V2,AXX2,AYY2,ACC2)
      CALL SAVMAX (ARRXY1,ARRX1,ARRY1,ARRT1,ARRDV1,ARRPS1,NARRP1,
     1            TM,TIMEP,AXX1,AYY1,ACC1,ACCP1,DELVS1,ACTST1,
     2            ABIG1,AXBIG1,AYBIG1,TBIG1,NUM1,ISAV1 ,IACDV1,
     3            IPRTY,ISTOP)
      CALL SAVMAX (ARRXY2,ARRX2,ARRY2,ARRT2,ARRDV2,ARRPS2,NARRP2,
     1            TM,TIMEP,AXX2,AYY2,ACC2,ACCP2,DELVS2,ACTST2,
     2            ABIG2,AXBIG2,AYBIG2,TBIG2,NUM2,ISAV2 ,IACDV2,
     3            IPRTY,ISTOP)
C
  220 ITFG1P  = ITFLG1
      ITFG2P = ITFLG2
      ITFLG1 = 0
      ITFLG2 = 0
      U1V1SQ = U1**2 + V1**2
      IF(U1V1SQ.GT.UVMN2) GO TO 25
      IF(ABS(PSI1D).GT.PSIDMA) GO TO 25
      ITFLG1 = 1
      IF(ITFLG1.EQ.ITFG1P) GO TO 241
      TREST1 = T
      TCOLS1 = TREST1 - TCOL
      U1V1E = (SQRT(U1V1SQ))/ 12.0
      P1TEM = PSI1D/RAD
  241 IF(IVEH) 26,80,26
C
   25 IF(IVEH.EQ.0) GO TO 20
   26 U2V2SQ = U2**2 + V2**2
      IF(U2V2SQ.GT.UVMN2) GO TO 31
      IF(ABS(PSI2D).GT.PSIDMA) GO TO 31
      ITFLG2 = 1
      IF(ITFLG2.EQ.ITFG2P) GO TO 281
      TREST2 = T
      TCOLS2 = TREST2 - TCOL
      U2V2E  = (SQRT(U2V2SQ))/ 12.0
      P2TEM  = PSI2D/RAD
  281 IF(ITFLG1) 80,31,80
C
C     OMIT CALL TO OUTDIS
C
C  31 CALL OUTDIS
C
C     ST 31 IS REACHED ONLY WHEN IVEH.NE.0
C     TEST FOR CONTACT
C     COSINE(PSI1-PSI2) SAME AS COSINE(PSI2-PSI1)
C
   31 CPIJ = CPSI1 * CPSI2  +  SPSI1 * SPSI2
      I = 1
      J = 2
   32 XCXC = XCMXCI(I)
      YCYC = YCMYCI(I)
      SPJ  = SPSII(J)
      CPJ  = CPSII(J)
      SPIJ = SPSII(I) * CPJ  -  CPSII(I)*SPJ
      XFJJ = EJJ(1,J)
      XRJJ = EJJ(3,J)
      YSJJ = GJJ(1,J)
      XICRTM = YCYC*SPJ + XCXC*CPJ
      YICRTM = YCYC*CPJ - XCXC*SPJ
C
C        VEHICLE I CORNER POINTS IN VEHICLE J COORDINATES
C        RF = 1,  LF = 2,  RR = 3,  LR = 4
C
          DO 35 IC = 1,4
          EJJI = EJJ(IC,I)
          GJJI = GJJ(IC,I)
          XICORJ = XICRTM              + EJJI*CPIJ - GJJI*SPIJ
          YICORJ = YICRTM              + EJJI*SPIJ + GJJI*CPIJ
          IF((XRJJ.LT.XICORJ).AND.(XICORJ.LT.XFJJ).AND.
     1      ((-YSJJ).LT.YICORJ).AND.(YICORJ.LT.YSJJ)) GO TO 37
   35     CONTINUE
      IF(I.GT.1) GO TO 45
      I = 2
      J = 1
      GO TO 32
C
   37 IF(ITCOL.NE.0) GO TO 39
      TCOL   = T
      ITCOL  = 1
      XCP1C  = XCP1
      YCP1C  = YCP1
      PSI1C  = PSI1
      U1C    = U1
      V1C    = V1
      PSI1DC = PSI1D
      XCP2C  = XCP2
      YCP2C  = YCP2
      PSI2C  = PSI2
      U2C    = U2
      V2C    = V2
      PSI2DC = PSI2D
      GO TO 41
C
   39 IF(ICOLTR.EQ.0) GO TO 42
      IF((ACC1.LE.1.0).AND.(ACC2.LE.1.0)) GO TO 20
   41 ICOLL  = 1
      ICOLTR = 0
      DTP    = DT
      DT     = DTCOLL
      DTPRNT = DTCOLL
      TPRINT = T
C
C      TDGT = T
C
      IQ     = 0
      CALL SETIND(PSI1,PSI2,XCMXC1,YCMYC1, PSCC1,PSCC2,IND1,IND2)
      GO TO 18
C
   42 IF((ACC1.GT.1.0).OR.(ACC2.GT.1.0)) GO TO 20
      IF(ICOLAC.GT.5) GO TO 44
      ICOLAC= ICOLAC+1
      GO TO 20
C
   44 TTEST = T + TTADD
      IF( AMOD(TTEST,DTCOLT)  - DTCOLL) 47,20,20
   45 IF(ICOLTR.NE.0) GO TO 50
      TTEST = T + TTADD
      IF( AMOD(TTEST,DTCOLT)  - DTCOLL) 47,20,20
   47 ICOLTR = 1
      ICOLLP = 1
      ICOLAC = 0
      DTP = DT
      DT = DTCOLT
C
C     DTPRNT=DTPRN0     RESET NOT DONE
C
      TPRINT = T
C
C      TDGT = T
C
      IND = 1
      GO TO 53
C
   50 IF (IQ.NE.100) GO TO 53
      DTP = DT
      DT  = DTTRAJ
      TPRINT = T
C
C      TDGT = T
C
      IND = 1
   53 IQ = IQ + 1
   55 IF(IND.EQ.0) GO TO 20
      IND = 0
      GO TO 18
C
   80 NMSG  = NOUT
      IPRTY = 2
      ACCP1 = ACC1
      CALL ACCEL(G,DU1,DV1,DPSI1,U1,V1,AXX1,AYY1,ACC1)
      IF(IVEH.EQ.0) GO TO 802
      ACCP2 = ACC2
      CALL ACCEL(G,DU2,DV2,DPSI2,U2,V2,AXX2,AYY2,ACC2)
      CALL SAVMAX (ARRXY1,ARRX1,ARRY1,ARRT1,ARRDV1,ARRPS1,NARRP1,
     1            TM,TIMEP,AXX1,AYY1,ACC1,ACCP1,DELVS1,ACTST1,
     2            ABIG1,AXBIG1,AYBIG1,TBIG1,NUM1,ISAV1 ,IACDV1,
     3            IPRTY,ISTOP)
      CALL SAVMAX (ARRXY2,ARRX2,ARRY2,ARRT2,ARRDV2,ARRPS2,NARRP2,
     1            TM,TIMEP,AXX2,AYY2,ACC2,ACCP2,DELVS2,ACTST2,
     2            ABIG2,AXBIG2,AYBIG2,TBIG2,NUM2,ISAV2 ,IACDV2,
     3            IPRTY,ISTOP)
  802 CALL OUTPUT(2)
C      CALL PLOTAP(3)
      IF(ITFLG1.EQ.0) GO TO 84
      WRITE(NOUT,6025) TREST1,NO1,U1V1E,NO1,P1TEM
 6025 FORMAT('0  At T =',F8.4,' sec, Vehicle ',I2,' moving slowly'/22X,
     1       ' Speed =',E13.5,' ft/sec, PSI ',I1,' D =',E13.5,
     2' deg/sec')
      IF(IVEH.NE.0) GO TO 85
      WRITE(NOUT,6026)
 6026 FORMAT('0  STOP, this case has one vehicle')
      GO TO 90
C
   84 IF(IVEH.EQ.0) GO TO 90
   85 IF(ITFLG2.EQ.0) GO TO 90
      WRITE(NOUT,6025) TREST2,NO2,U2V2E,NO2,P2TEM
      IF(ITFLG1.EQ.0) GO TO 90
      WRITE(NOUT,6028) T
 6028 FORMAT('0 STOP AT T=',F8.4,' sec, both vehicles moving slowly')
   90 IF(ISTOP.EQ.0) GO TO 10
C
C     ST 10 REPEATS WITH NEW INPUT, RETAINING DESIRED OLD INPUT
C
      WRITE(NOUT,6080)  T,ISTOP
 6080 FORMAT('0 STOP AT ',F9.4,' sec, ISTOP =',I3)
 9999 RETURN
      END
