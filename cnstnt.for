      SUBROUTINE CNSTNT
C      SIMULATION MODEL OF AUTOMOBILE COLLISIONS -SMAC
      COMMON/CONST/ G,RAD,PI,TWOPI,PIO2,PI32,ND2,ND4,ND8,NIN,NOUT
      COMMON/INTG/NEQ,T,DT,VAR(12),DER(12)
      EQUIVALENCE (VAR(1),XCP1),(VAR(2),YCP1),(VAR(3),PSI1),
     1            (VAR(4),PSI1D),(VAR(5),U1),(VAR(6),V1),
     2            (VAR(7),XCP2),(VAR(8),YCP2),(VAR(9),PSI2),
     3            (VAR(10),PSI2D),(VAR(11),U2),(VAR(12),V2)
      EQUIVALENCE (DER(1),DXCP1),(DER(2),DYCP1),(DER(3),DPSI1),
     1            (DER(4),DPSI1D),(DER(5),DU1),(DER(6),DV1),
     2            (DER(7),DXCP2),(DER(8),DYCP2),(DER(9),DPSI2),
     3            (DER(10),DPSI2D),(DER(11),DU2),(DER(12),DV2)
      COMMON/INPT/  T0,TF,DTTRA0,DTCOL0,DTCLT0,DTPRN0,UVMIN,PSIDMN,FVEH0
     1             ,XCP10,YCP10,PSI10,PSI1D0,U10,V10,
     2              XCP20,YCP20,PSI20,PSI2D0,U20,V20,
     3              A1,B1,TR1,FIZ1,FM1,PSIR10,XF1,XR1,YS1,
     4              A2,B2,TR2,FIZ2,FM2,PSIR20,XF2,XR2,YS2,
     5              CSTFI(8),TBTQ1,TETQ1,TINCQ1,NTBLQ1,NTQ1,
     6              TBTQ2,TETQ2,TINCQ2,NTBLQ2,NTQ2,TII(8,201),
     7              TBPSF1,TEPSF1,TINCP1,NTBLP1,NPSF1,
     8              TBPSF2,TEPSF2,TINCP2,NTBLP2,NPSF2,PSIFI(4,201),
     9              XBP(2),YBP(2),XMU1,XMU2,CMU
      COMMON/INPT/  DELPS0,DELRO0,ALAMB,ZETAV,AKV(2) ,AMU,C0,C1,C2,
     1              PSLM10,PSLM20,PSLM30,PSLM40,PSLM50,PSLM60,PSLM70,
     2              PSLM80,HED(40),DADE(3),XINPUT(9)
      COMMON/INTGR/JCC(4),JCOR(4),NPSIB,IPSIB0,IPSIB,IBB,IFF,NDTAB,
     1             I9,J9(361,2),  NPSJB,IPSJB,I3,ILAST,IL,IND1,IND2,INDI
     2             ,INDJ,ISTOP,ITZER1,ITZER2,IPZER1,IPZER2,ICOUNT,INDXB,
     3             ICOLLP,ICOLL,IQ,IND,IVEH,LL,ICTVDI,ITCOL,ITFLG1,
     4             ITFLG2,NWRDB1,NWRDE1,NWRDB2,NWRDE2,ICOLAC
C             IN COMMON /COMP/ DO NOT DISTURB THE ORDER OF THE VARIABLES
C                              WHICH ARE EQUIVALENCED TO ARRAYS.
      COMMON/COMP/  DTTRAJ,DTCOLL,DTCOLT,DTPRNT,UVMN2,PSIDMA,TPRINT,DTP,
     1              U1V1SQ,U2V2SQ,DELPSI,DELPST,DELPS2,DELRHO,
     2              PSILM1,PSILM2,PSILM3,PSILM4,PSILM5,PSILM6,PSILM7,
     3              PSILM8,EJJ(4,2),GJJ(4,2),C1OC2,PSCC,PSIR1,PSIR2,
     4             XCMXC1,XCMXC2,YCMYC1,YCMYC2,SPSI1,SPSI2,CPSI1,CPSI2,
     5             XCPI,YCPI,PSII,XCPJ,YCPJ,PSIJ,XCMXC,YCMYC,SPSIJ,
     6             CPSIJ,XFI,XRI,YSI,XFJ,XRJ,YSJ,AKVI,AKVJ,EJ,GJ,
     7             XPJ(4),YPJ(4),ANGYX,SPAN,PSIBPI(4),PSIBPB,PSIBPF,
     8             FNPSIB,PSIBB,PSIB,PSFMPS,SCPSIB,CSPSIB,
     9             RHOBI,RHOBIN(4),PSIBIJ,SPSBIJ,CPSBIJ,XBIJ,YBIJ,PSJTB
      COMMON/COMP/ PSIBPJ,FNPSJB,PSIBJ,RHOBJ,XYJSQR,SPSIB,CPSIB,XBI,YBI,
     1         PRESI,PRESJ,XYSR,DELTA,CRHO,RHOBIC,RHOBMX,RHOBIT,RHOBT,
     2             SPSI21,CPSI21,X2TEM,Y2TEM,XX,YY,PAV,XXYYSR,FN1,SPSF,
     3             CPSF,X1AV,Y1AV,XYAVSR,X2TERM,Y2TERM,SPS21F,CPS21F,
     4             X2AV,Y2AV,VT1AV,VT2AV,VTMVT,FRICT,FNX1,FNY1,FNN1,
     5             FNX2,FNY2,FNN2,SFX1,SFY1,SFN1,SFX2,SFY2,SFN2,
     6              SFX1C,SFX2C,SFY1C,SFY2C,SFN1C,SFN2C,
     7              SFX1T,SFX2T,SFY1T,SFY2T,SFN1T,SFN2T, TCOL,TEND,
     8              TREST1,TREST2,TCOLS1,TCOLS2,P1TEM,P2TEM,U1V1E,U2V2E,
     9              EXTRA(10)
      COMMON/COMPT/ W(8),XWP(8),YWP(8),FLAGW(8),PSIW(8),TQW(8),
     1             TFX,TFY,TMOM,PSIRR,COEF,COEF1,COEF2,TRD2,TRD21,TRD22,
     2             XBMXB,FNUM,A,B,FIZ,FMASS,XC,YC,U,V,PSIC,PSICD,UD2,
     3             SGNU,SGNI,AOMB,CSPSIC,SNPSIC,TRCPSC,TRSPSC,TRPSCD,
     4             XI,XW,YW,SX,SY,S,XPP,YPP,RHO,RHOP,XMUS,XMU,PSI,XNUM,
     5             XDEN,RATIO,ALFA,F,TIF,FC,FCOS,SMAL,FSMX,FS,BETB,FX,FY
     6             ,CSPSI,SNPSI,XCXC,YCYC,SPJ,CPJ,SPIJ,CPIJ,XFJJ,XRJJ,
     7              YSJJ,EJJI,GJJI,XICORJ,YICORJ,NTQ,TBTQ,TETQ,TINCRQ,
     8             NPSF,TBPSF,TEPSF,TINCRP
      COMMON/TAB/  TRHOB(361,2),TROBMX(361,2),TPSIB(361,2),
     1             TCPSIB(361,2),TSPSIB(361,2),TXB1(100),TYB1(100),
     2             TPSB1(100),TPRES1(100)
      DIMENSION   XCMXCI(2),YCMYCI(2),SPSII(2),CPSII(2),PSLM0(8),PSLM(8)
      EQUIVALENCE (XCMXCI(1),XCMXC1),(YCMYCI(1),YCMYC1),(SPSII(1),SPSI1)
     1           ,(CPSII(1),CPSI1),(PSLM0(1),PSLM10),(PSLM(1),PSILM1)
C        COMMON VDICON HAS CONSTANTS USED FOR VEHICLE DAMAGE INDEX
      COMMON/VDICON/EXTF1( 9),EXTR1( 9),EXTB1( 9),PSP1(12),
     2              EXTF2( 9),EXTR2( 9),EXTB2( 9),PSP2(12),NCOL51(10),
     2              NCOL52(10),MMM( 9)
      EQUIVALENCE (XINPUT(1),FMOVIE)
      COMMON /MOVIE/ MOVIE,NMSG
      DATA ME/1HE/
      DATA M1/1H1/, M2/1H2/, M3/1H3/, M4/1H4/, M5/1H5/, M6/1H6/
      DATA M7/1H7/, M8/1H8/, M9/1H9/
C
C      TIME INTERVALS AND STOPPING TESTS
      DTTRAJ = DTTRA0
      DTCOLL = DTCOL0
      DTCOLT = DTCLT0
      DTPRNT = DTPRN0
      UVMN2 = UVMIN * ABS(UVMIN)
      PSIDMA = PSIDMN * RAD
C      TERRAIN BOUNDARIES
      INDXB = 1
      XBMXB = XBP(2) - XBP(1)
      IF(XBMXB) 11,10,11
   10 INDXB = 0
      XPP = XBP(1)
      GO TO 12
   11 XI = (YBP(2)-YBP(1))/ XBMXB
      FNUM =YBP(1) - XI*XBP(1)
   12 XCP1 = XCP10
      YCP1 = YCP10
      PSI1 = PSI10 * RAD
      PSI1D = PSI1D0 * RAD
      U1   =U10
      V1   = V10
      PSIR1 = PSIR10*RAD
      TRD21 = TR1/2.0
      COEF1 = FM1*G /(2.0*(A1+B1))
      W(1) = B1* COEF1
      W(3) = A1* COEF1
      W(2) = W(1)
      W(4) = W(3)
C          IVEH = 0 FOR ONE VEHICLE,  =1 FOR TWO VEHICLES
      IVEH = FVEH0 + 0.2
      IVEH = IVEH - 1
      IF(IVEH) 18,15,18
   15 NEQ = 6
      IF(FMOVIE) 16,17,16
   16 STOP
C      CANNOT HAVE COLLISON DAMAGE IN THIS PGM WITH ONLY ONE VEHICLE
   17 RETURN
   18 NEQ = 12
C         NEQ INTEGRATES 6 EQUATIONS FOR ONE VEHICLE, 12 EQ FOR TWO VEH.
      XCP2 = XCP20
      YCP2 = YCP20
      PSI2 = PSI20 * RAD
      PSI2D = PSI2D0 * RAD
      U2   = U20
      V2   = V20
      PSIR2 = PSIR20*RAD
      TRD22 = TR2/2.0
      COEF2 = FM2*G /(2.0*(A2+B2))
      W(5) = B2*COEF2
      W(7) = A2*COEF2
      W(6) = W(5)
      W(8) = W(7)
C          CORNER IDENTIFICATION
C          1   RF
C          2   LF
C          3   RR
C          4   LR
C          VEHICLE 1
      EJJ(1,1)  = XF1
      EJJ(2,1)  = XF1
      EJJ(3,1)  = XR1
      EJJ(4,1)  = XR1
      GJJ(1,1)  = YS1
      GJJ(2,1)  =-YS1
      GJJ(3,1)  = YS1
      GJJ(4,1)  =-YS1
C          VEHICLE 2
      EJJ(1,2)  = XF2
      EJJ(2,2)  = XF2
      EJJ(3,2)  = XR2
      EJJ(4,2)  = XR2
      GJJ(1,2)  = YS2
      GJJ(2,2)  =-YS2
      GJJ(3,2)  = YS2
      GJJ(4,2)  =-YS2
C               XR1 AND XR2 ARE INPUT AS NEGATIVE QUANTITIES
      DELRHO = DELRO0
      DELPSI = DELPS0 * RAD
      DELPST =  0.01*DELPSI
      DELPS2 = 0.5 * DELPSI
      NDTAB = TWOPI/DELPSI  + 1.01
C          TABLES I AND J  HAVE NDTAB POSSIBLE ENTRIES
      C1OC2 = 0.5 * C1/C2
      PSILM1 = PSLM10 *RAD
      PSILM2 = PSLM20 *RAD
      PSILM3 = PSLM30 *RAD
      PSILM4 = PSLM40 *RAD
      PSILM5 = PSLM50 *RAD
      PSILM6 = PSLM60 *RAD
      PSILM7 = PSLM70 *RAD
      PSILM8 = PSLM80 *RAD
C
   26 IF(FMOVIE) 27,28,27
   27 MOVIE = 1
      NMSG = 2
      GO TO 29
C        MOVIE NE 0 WRITES DAMAGE TABLES ON TAPE AND ON FT02 AT EACH
C        TIME POINT
   28 MOVIE = 0
      NMSG = NOUT
C            EXTF1 AND SO ON USED FOR VEHICLE DAMAGE INDEX
   29 EXTF1(1) = 0.0
      EXTF1(2) = 0.125 * XF1
      EXTF1(3) = 0.250 * XF1
      EXTF1(4) = 0.375 * XF1
      EXTF1(5) = 0.500 * XF1
      EXTF1(6) = 0.625 * XF1
      EXTF1(7) = 0.846 * XF1
      EXTF1(8) = 0.946 * XF1
      EXTF1(9) = 1.046 * XF1
      EXTF2(1) = 0.0
      EXTF2(2) = 0.125 * XF2
      EXTF2(3) = 0.250 * XF2
      EXTF2(4) = 0.375 * XF2
      EXTF2(5) = 0.500 * XF2
      EXTF2(6) = 0.625 * XF2
      EXTF2(7) = 0.846 * XF2
      EXTF2(8) = 0.946 * XF2
      EXTF2(9) = 1.046 * XF2
      EXTR1(1) = 0.0
      EXTR1(2) = 0.165 * YS1
      EXTR1(3) = 0.253 * YS1
      EXTR1(4) = 0.502 * YS1
      EXTR1(5) = 0.751 * YS1
      EXTR1(6) = 1.000 * YS1
      EXTR1(7) = 1.249 * YS1
      EXTR1(8) = 1.498 * YS1
      EXTR1(9) = 1.747 * YS1
      EXTR2(1) = 0.0
      EXTR2(2) = 0.165 *YS2
      EXTR2(3) = 0.253 *YS2
      EXTR2(4) = 0.502 *YS2
      EXTR2(5) = 0.751 *YS2
      EXTR2(6) = 1.000 *YS2
      EXTR2(7) = 1.249 *YS2
      EXTR2(8) = 1.498 *YS2
      EXTR2(9) = 1.747 *YS2
      EXTB1(1) = 0.0
      EXTB1(2) = -0.084 * XR1
      EXTB1(3) = -0.168 * XR1
      EXTB1(4) = -0.252 * XR1
      EXTB1(5) = -0.336 * XR1
      EXTB1(6) = -0.421 * XR1
      EXTB1(7) = -0.588 * XR1
      EXTB1(8) = -0.769 * XR1
      EXTB1(9) = -0.950 * XR1
      EXTB2(1) = 0.0
      EXTB2(2) = -0.084 * XR2
      EXTB2(3) = -0.168 * XR2
      EXTB2(4) = -0.252 * XR2
      EXTB2(5) = -0.336 * XR2
      EXTB2(6) = -0.421 * XR2
      EXTB2(7) = -0.588 * XR2
      EXTB2(8) = -0.769 * XR2
      EXTB2(9) = -0.950 * XR2
C        ANGLES FOR COMPARISIONS IN VEHICLE DAMAGE INDEX (VDI)
      PSP1(1)= ATAN2(0.500*YS1,XF1)
      PSP1(2)= ATAN2(YS1,XF1)
      PSP1(3)= ATAN2(2.702*YS1,XF1)
      PSP1(4)= ATAN2(1.754*YS1,XR1)
      PSP1(5)= ATAN2(YS1,XR1)
      PSP1(6)= ATAN2(0.500*YS1,XR1)
C      PSP1(1) THRU PSP1(3) ARE IN FIRST QUADRANT
C      PSP1(4) THRU PSP1(6) ARE IN SECOND QUADRANT
C      PSP1(7) THRU PSP1(9) ARE IN THIRD QUADRANT , USES -YS1
C      PSP1(10)THRU PSP1(12)  ARE IN FOURTH QUADRANT,USES -YS1
C                XR1 AND XR2 ARE INPUT AS NEGATIVE QUANTITIES
      PSP1(12)= TWOPI - PSP1(1)
      PSP1(11)= TWOPI - PSP1(2)
      PSP1(10)= TWOPI - PSP1(3)
      PSP1(9) = TWOPI - PSP1(4)
      PSP1(8) = TWOPI - PSP1(5)
      PSP1(7) = TWOPI - PSP1(6)
      PSP2(1)= ATAN2(0.500*YS2,XF2)
      PSP2(2)= ATAN2(YS2,XF2)
      PSP2(3) = ATAN2(2.702*YS2,XF2)
      PSP2(4)= ATAN2(1.754*YS2,XR2)
      PSP2(5)= ATAN2(YS2,XR2)
      PSP2(6) = ATAN2(0.500*YS2,XR2)
      PSP2(12)=TWOPI - PSP2(1)
      PSP2(11)=TWOPI - PSP2(2)
      PSP2(10)=TWOPI - PSP2(3)
      PSP2(9) =TWOPI - PSP2(4)
      PSP2(8) =TWOPI - PSP2(5)
      PSP2(7) =TWOPI - PSP2(6)
C            VERTICAL DAMAGE LOCATION NOT APPLICABLE (NCOL51 AND NCOL52)
      DO 40 I=1,10
      NCOL51(I) =ME
   40 NCOL52(I) =ME
      MMM(1) = M1
      MMM(2) = M2
      MMM(3) = M3
      MMM(4) = M4
      MMM(5) = M5
      MMM(6) = M6
      MMM(7) = M7
      MMM(8) = M8
      MMM(9) = M9
      RETURN
      END